# Руководство по использованию программы управления файлами Google Drive

## Введение
Программа `main_des.py` обеспечивает графический интерфейс для работы с файлами Google Drive. С ее помощью вы можете просматривать файлы, у которых не переданы права, а также копировать файлы определенного сотрудника из указанной папки.

## Требования
- Python версии 3.6 или выше
- Необходимые библиотеки:
    - Tkinter
    - Pmw
    - google.oauth2
    - googleapiclient.discovery
    - datetime
- JSON-файл с учетными данными сервисного аккаунта Google

## Интерфейс программы
При запуске программы открывается главное окно, которое разделено на две части:
- Левая часть: содержит текстовое поле для вывода результатов и кнопку для отображения файлов с непереданными правами.
- Правая часть: содержит поля для ввода имени папки и email сотрудника, а также кнопку для проверки владения и копирования файлов.

## Функциональность
- Просмотр файлов с непереданными правами: при нажатии кнопки на текстовом поле отображаются файлы, у которых не переданы права на учетную запись сервиса и вашу учетную запись. Если таких файлов нет, будет выведено сообщение "Файлы не найдены".
- Копирование файлов сотрудника: введите имя папки в поле "Имя папки" и email сотрудника в поле "Email сотрудника" в правой части окна. При нажатии кнопки в текстовом поле отобразится результат проверки владения и копирования файлов.

## Описание функций
- `create_service()`: создает и возвращает объект сервиса Google Drive с использованием учетных данных из JSON.
- `list_files(service, text_widget)`: запрашивает и выводит список файлов, созданных более семи дней назад, у которых владельцы не совпадают с учетной записью сервиса или учетной записью аккаунта компании.
- `get_folder_id(service, folder_name)`: возвращает идентификатор папки по её названию.
- `check_ownership(service, folder_id, owner_email, text_widget)`: проверяет файлы в указанной папке, принадлежащие указанному сотруднику, и копирует их.
- `copy_file(service, file_id, file_name, text_widget)`: копирует файл по его идентификатору и названию, выводит результат операции.
- `on_list_files_button_click(text_widget)`: обработчик для кнопки "Показать файлы с непереданными правами". Создает сервис и вызывает функцию list_files.
- `on_check_ownership_button_click(folder_name_entry, owner_email_entry, text_widget)`: обработчик для кнопки "Скопировать файлы сотрудника". Проверяет ввод, создает сервис и вызывает функции get_folder_id и check_ownership.

Эта программа предоставляет простой интерфейс для управления файлами Google Drive, упрощая процесс просмотра и копирования файлов.
